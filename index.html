<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>For Shilu ‚ù§</title>
  <meta name="description" content="A tiny Valentine world made just for you Shilu ‚ù§Ô∏è" />
  <style>
    :root{
      --bg1:#ffd6e8;
      --bg2:#e8f6ff;
      --card:rgba(255,255,255,.75);
      --text:#2a2a2a;
      --muted:rgba(0,0,0,.55);
      --accent:#ff4d8d;
      --accent2:#7c5cff;
      --shadow:0 18px 60px rgba(0,0,0,.12);
      --radius:22px;
      --font:ui-rounded,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      overflow-x:hidden;
      background:
        radial-gradient(1200px 700px at 20% 10%, var(--bg2), transparent 60%),
        radial-gradient(1000px 600px at 80% 30%, var(--bg1), transparent 65%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    .layer{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
    }

    .wrap{
      position:relative;
      z-index:2;
      min-height:100%;
      display:grid;
      place-items:center;
      padding:22px;
    }

    .card{
      width:min(940px,100%);
      background:var(--card);
      backdrop-filter:blur(12px);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      border:1px solid rgba(255,255,255,.18);
      overflow:hidden;
      position:relative;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.18);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:750;
      letter-spacing:.3px;
    }

    .controls{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btn,.chip{
      border:none;
      cursor:pointer;
      border-radius:999px;
      padding:10px 14px;
      font-weight:650;
      transition:transform .08s ease, background .18s ease, box-shadow .18s ease;
      user-select:none;
      font-family:inherit;
      outline:none;
    }
    .chip{
      background:rgba(255,255,255,.55);
      color:rgba(0,0,0,.75);
      border:1px solid rgba(0,0,0,.08);
    }
    .btn:active,.chip:active{transform:translateY(1px) scale(.99)}

    .content{
      padding:22px;
      display:grid;
      gap:18px;
    }

    .hero{
      display:grid;
      grid-template-columns:1.2fr .8fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width:860px){ .hero{grid-template-columns:1fr;} }

    .panel{
      border-radius:18px;
      background:rgba(255,255,255,.42);
      border:1px solid rgba(255,255,255,.25);
      padding:18px;
      position:relative;
      overflow:hidden;
    }

    .ribbon{
      position:absolute;
      top:14px; right:14px;
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.65);
      border:1px solid rgba(0,0,0,.08);
      color:rgba(0,0,0,.65);
    }

    .title{
      font-size:clamp(28px,4vw,44px);
      line-height:1.05;
      margin:0 0 8px;
      letter-spacing:-.4px;
    }

    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:15.5px;
      line-height:1.55;
    }

    .sparkleText{
      display:inline-block;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      font-weight:850;
    }

    .mini{ display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; }
    .pill{
      font-size:12.5px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.08);
      color:rgba(0,0,0,.70);
    }

    /* Letter */
    .letterBox{display:grid; gap:12px;}
    .letter{
      min-height:170px;
      padding:16px;
      border-radius:16px;
      background:rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.08);
      box-shadow:0 10px 30px rgba(0,0,0,.08);
      position:relative;
    }
    .typing{ font-size:15.8px; line-height:1.7; white-space:pre-wrap; }
    .caret{
      display:inline-block;
      width:9px; height:16px;
      background:currentColor;
      margin-left:3px;
      transform:translateY(2px);
      animation:blink .9s infinite;
      opacity:.8;
    }
    @keyframes blink{0%,49%{opacity:1}50%,100%{opacity:0}}

    /* Question */
    .question{ text-align:center; padding:18px 18px 22px; }
    .qTitle{ margin:0 0 8px; font-size:clamp(22px,3vw,30px); letter-spacing:-.2px; }
    .qHint{ margin:0 0 16px; color:var(--muted); font-size:14px; }
    .actions{
      display:flex; justify-content:center; gap:12px; flex-wrap:wrap;
      position:relative; min-height:64px;
    }
    .btnPrimary{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:white;
      padding:12px 18px;
      box-shadow:0 16px 40px rgba(255,77,141,.25);
    }
    .btnGhost{
      background:rgba(255,255,255,.55);
      color:rgba(0,0,0,.75);
      border:1px solid rgba(0,0,0,.1);
      padding:12px 18px;
      position:relative;
    }
    .red-heart{ color:#ff2b55; }

    /* Confetti canvas */
    #confetti{ position:fixed; inset:0; pointer-events:none; z-index:5; }

    /* Modal Base */
    .modal{
      position:fixed; inset:0;
      display:none; place-items:center;
      background:rgba(0,0,0,.55);
      z-index:10;
      padding:18px;
    }
    .modal[open]{display:grid;}
    .modalCard{
      width:min(820px,100%);
      border-radius:22px;
      padding:14px;
      background:rgba(255,255,255,.92);
      box-shadow:0 30px 90px rgba(0,0,0,.35);
      border:1px solid rgba(0,0,0,.08);
      text-align:center;
    }

    /* Gallery */
    .galleryTitle{
      margin:6px 0 10px;
      font-size:18px;
      font-weight:800;
    }

    /* ‚úÖ Fixed 1280x1600 ratio (4:5) frame */
    .frame{
      width: min(520px, 92vw);
      aspect-ratio: 4 / 5;   /* 1280:1600 */
      margin: 0 auto;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.08);
      box-shadow:0 18px 60px rgba(0,0,0,.18);
      background:rgba(255,255,255,.35);
      position:relative;
      user-select:none;
      -webkit-user-select:none;
      touch-action:pan-y;
    }

    .galleryImg{
      width:100%;
      height:100%;
      display:block;
      object-fit: cover;       /* fill the 4:5 frame */
      object-position: center; /* keep center */
      transform:scale(1.02);
      filter: blur(16px) brightness(0.9);
      transition: filter 1.6s ease, transform 1.6s ease, opacity .18s ease;
      opacity: 1;
    }
    .frame.revealed .galleryImg{
      filter: blur(0px) brightness(1);
      transform:scale(1);
    }

    .navBtn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:42px; height:42px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.12);
      background:rgba(255,255,255,.75);
      display:grid;
      place-items:center;
      cursor:pointer;
      font-size:18px;
      font-weight:900;
      user-select:none;
    }
    .navBtn:active{ transform:translateY(-50%) scale(0.98); }
    .prev{ left:10px; }
    .next{ right:10px; }

    .dots{
      display:flex;
      justify-content:center;
      gap:6px;
      padding:10px 0 2px;
      flex-wrap:wrap;
    }
    .dot{
      width:8px; height:8px;
      border-radius:999px;
      background:rgba(0,0,0,.18);
    }
    .dot.active{ background: rgba(255,77,141,.9); }

    .hintRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .smallText{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }

    /* Floating hearts */
    .heart{
      position:absolute;
      bottom:-30px;
      width:14px; height:14px;
      transform:rotate(45deg);
      opacity:.85;
      filter:drop-shadow(0 10px 16px rgba(0,0,0,.12));
      animation:floatUp linear forwards;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:14px; height:14px;
      border-radius:50%;
      background:inherit;
    }
    .heart::before{left:-7px; top:0;}
    .heart::after{top:-7px; left:0;}
    @keyframes floatUp{
      from{transform:translateY(0) rotate(45deg);}
      to{transform:translateY(-115vh) rotate(45deg);}
    }
  </style>
</head>

<body>
  <!-- Put song.mp3 and 1.jpeg ... 10.jpeg in SAME folder as index.html -->
  <audio id="bgMusic" preload="auto" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <canvas id="confetti"></canvas>
  <div class="layer" id="particlesLayer" aria-hidden="true"></div>

  <div class="wrap">
    <main class="card">
      <div class="topbar">
        <div class="brand">
          <span style="font-size:18px;">‚ù§</span>
          <span>For <span class="sparkleText">Shilu</span></span>
        </div>

        <div class="controls">
          <button class="chip" id="restartBtn">‚Üª Restart Letter</button>
        </div>
      </div>

      <div class="content">
        <section class="hero">
          <div class="panel">
            <div class="ribbon">Crafted with all my heart ‚ù§Ô∏è ‚ú®</div>
            <h1 class="title">Shilu‚Ä¶<br/>I couldn‚Äôt hug you, so I made this instead for <span class="sparkleText">you</span> üíå</h1>
            <p class="subtitle">
              This space is made just for US ‚Äî a tiny world where every word is wrapped in warmth.
              It‚Äôs calm like your voice, comforting like your hugs, and bright like your smile.
              And maybe a little dramatic too‚Ä¶ because that‚Äôs exactly how my heart feels about you.
              
              Here, every sentence carries a piece of my love.
              Every line whispers how much I miss you.
              And every word reminds you that no matter the distance, you are always my home.

            </p>
            <div class="mini">
              <span class="pill">üéÄ Love you Shilu</span>
            </div>
          </div>

          <div class="panel letterBox">
            <h2 style="margin:0; font-size:18px;">Made you smile already, didn‚Äôt I?</h2>
            <div class="letter" aria-live="polite">
              <div class="typing" id="typingText"></div><span class="caret" id="caret"></span>
            </div>
            <p style="margin:0; color:var(--muted); font-size:13px;">
              Tap restart if you want to re-read it ‚ú®
            </p>
          </div>
        </section>

        <section class="panel question" id="questionPanel">
          <h2 class="qTitle">
            So‚Ä¶ will you be my Valentine, Shilu
            <span class="red-heart">‚ù§</span>
          </h2>
          <p class="qHint">Choose wisely üòå (the ‚ÄúNo‚Äù button is a little shy)</p>

          <div class="actions" id="actions">
            <button class="btn btnPrimary" id="yesBtn">Yes üíï</button>
            <button class="btn btnGhost" id="noBtn">No üôà</button>
          </div>
        </section>

        <div class="footerNote"></div>
      </div>
    </main>
  </div>

  <!-- GALLERY POPUP (shows on YES) -->
  <dialog class="modal" id="galleryModal">
    <div class="modalCard">
      <div class="galleryTitle" id="galleryTitle">A little memory for you, Shilu üíñ</div>

      <div class="frame" id="frame" aria-label="Swipe left or right to view photos">
        <button class="navBtn prev" id="prevBtn" aria-label="Previous photo">‚Äπ</button>
        <img class="galleryImg" id="galleryImg" src="1.jpeg" alt="Memory photo">
        <button class="navBtn next" id="nextBtn" aria-label="Next photo">‚Ä∫</button>
      </div>

      <div class="dots" id="dots"></div>

      <div class="hintRow">
        <p class="smallText" id="counterText">1 / 10</p>
        <p class="smallText">Swipe ‚óÄ ‚ñ∂ or use arrows</p>
        <button class="btn btnPrimary" id="closeGalleryBtn">Back ‚ú®</button>
      </div>
    </div>
  </dialog>

  <script>
    function rand(min,max){ return Math.random()*(max-min)+min; }

    const particlesLayer = document.getElementById('particlesLayer');
    const music = document.getElementById('bgMusic');

    const typingTextEl = document.getElementById('typingText');
    const caret = document.getElementById('caret');
    const restartBtn = document.getElementById('restartBtn');

    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const actions = document.getElementById('actions');

    const galleryModal = document.getElementById('galleryModal');
    const closeGalleryBtn = document.getElementById('closeGalleryBtn');
    const galleryImg = document.getElementById('galleryImg');
    const frame = document.getElementById('frame');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const dotsEl = document.getElementById('dots');
    const counterText = document.getElementById('counterText');

    // Floating hearts
    function spawnHeart(){
      const el = document.createElement('div');
      el.className = 'heart';

      const left = rand(0,100);
      const size = rand(10,22);
      const duration = rand(5.5,10.5);
      const color = (Math.random() < 0.5) ? 'rgba(255,77,141,0.9)' : 'rgba(124,92,255,0.85)';

      el.style.left = left + 'vw';
      el.style.width = size + 'px';
      el.style.height = size + 'px';
      el.style.background = color;
      el.style.animationDuration = duration + 's';
      el.style.opacity = rand(0.55,0.95);

      particlesLayer.appendChild(el);
      setTimeout(() => el.remove(), duration * 1000);
    }
    setInterval(spawnHeart, 240);

    // Typing letter
   
    // Typing letter
    const letter = [
    "Dear Shilu ‚ù§Ô∏è,",
    ,
    "It‚Äôs been 2,677 days since we started our beautiful journey together.",
    "In these days, we‚Äôve shared everything ‚Äî love, laughter, tears, fights, long talks, and even painful distances.",
    "I believe every single moment, even the hard ones, only made our bond stronger and our love deeper.",
    "",
    "Now we are miles apart, but I promise you ‚Äî this distance is only temporary.",
    "",
    "I miss your love, your warm hugs, your kisses, your smell, your smile‚Ä¶ and yes, even your food.",
    "Right now, all I want is a deep hug from you ü´Ç‚ù§Ô∏è.",
    "",
    "No matter the distance, my heart has always been with you and always will be.",
    "",
    "Love you always,",
    "Will you be my Valentine?"
    ].join("\n");


    let typingIndex = 0;
    let typingTimer = null;

    function startTyping(){
      clearInterval(typingTimer);
      typingIndex = 0;
      typingTextEl.textContent = "";
      caret.style.display = "inline-block";

      const speed = 18;
      typingTimer = setInterval(() => {
        typingTextEl.textContent += letter[typingIndex] || "";
        typingIndex++;
        if (typingIndex >= letter.length){
          clearInterval(typingTimer);
          caret.style.display = "none";
        }
      }, speed);
    }
    restartBtn.addEventListener('click', startTyping);
    startTyping();

    // "No" button run away
    function moveNoButton(){
      const rect = actions.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();
      const maxX = rect.width - btnRect.width;
      const maxY = rect.height - btnRect.height;
      noBtn.style.position = "absolute";
      noBtn.style.left = Math.max(0, Math.min(maxX, rand(0, maxX))) + "px";
      noBtn.style.top  = Math.max(0, Math.min(maxY, rand(0, maxY))) + "px";
    }
    noBtn.addEventListener('mouseenter', moveNoButton);
    noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNoButton(); }, {passive:false});

    // Confetti
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');
    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth * devicePixelRatio;
      confettiCanvas.height = window.innerHeight * devicePixelRatio;
      confettiCanvas.style.width = window.innerWidth + "px";
      confettiCanvas.style.height = window.innerHeight + "px";
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    let confetti = [];
    let confettiAnim = null;

    function popConfetti(){
      const palette = ["#ff4d8d", "#7c5cff", "#ffd6e8", "#e8f6ff", "#ffffff"];
      const count = 180;
      confetti = [];
      for (let i = 0; i < count; i++){
        confetti.push({
          x: rand(0, window.innerWidth),
          y: rand(-40, window.innerHeight * 0.2),
          w: rand(6, 14),
          h: rand(6, 14),
          vx: rand(-2.2, 2.2),
          vy: rand(2.2, 5.4),
          rot: rand(0, Math.PI),
          vr: rand(-0.2, 0.2),
          color: palette[Math.floor(rand(0, palette.length))]
        });
      }
      const start = performance.now();
      const duration = 2400;

      cancelAnimationFrame(confettiAnim);
      function frameAnim(t){
        ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        const elapsed = t - start;

        for (const p of confetti){
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.03;
          p.rot += p.vr;

          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
          ctx.restore();
        }

        confetti = confetti.filter(p => p.y < window.innerHeight + 50);

        if (elapsed < duration && confetti.length){
          confettiAnim = requestAnimationFrame(frameAnim);
        } else {
          ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        }
      }
      confettiAnim = requestAnimationFrame(frameAnim);
    }

    // Gallery (10 images) - JPEG
    const totalImages = 10;
    const images = Array.from({length: totalImages}, (_, i) => `${i+1}.jpeg`);
    let index = 0;

    function renderDots(){
      dotsEl.innerHTML = "";
      for (let i = 0; i < totalImages; i++){
        const d = document.createElement('div');
        d.className = "dot" + (i === index ? " active" : "");
        d.addEventListener('click', () => goTo(i));
        dotsEl.appendChild(d);
      }
    }

    function revealCurrent(){
      frame.classList.remove('revealed');
      galleryImg.style.opacity = "0.25";
      setTimeout(() => {
        galleryImg.style.opacity = "1";
        frame.classList.add('revealed');
      }, 220);
    }

    function goTo(i){
      index = (i + totalImages) % totalImages;
      galleryImg.src = images[index];
      counterText.textContent = `${index+1} / ${totalImages}`;
      renderDots();
      revealCurrent();
    }
    function next(){ goTo(index + 1); }
    function prev(){ goTo(index - 1); }

    prevBtn.addEventListener('click', prev);
    nextBtn.addEventListener('click', next);

    window.addEventListener('keydown', (e) => {
      if (!galleryModal.hasAttribute('open')) return;
      if (e.key === "ArrowRight") next();
      if (e.key === "ArrowLeft") prev();
      if (e.key === "Escape") closeGallery();
    });

    // Swipe support
    let startX = 0, startY = 0, tracking = false;
    frame.addEventListener('touchstart', (e) => {
      if (!galleryModal.hasAttribute('open')) return;
      const t = e.touches[0];
      startX = t.clientX;
      startY = t.clientY;
      tracking = true;
    }, {passive:true});
    frame.addEventListener('touchend', (e) => {
      if (!tracking) return;
      tracking = false;
      const t = e.changedTouches[0];
      const dx = t.clientX - startX;
      const dy = t.clientY - startY;
      if (Math.abs(dx) > 40 && Math.abs(dx) > Math.abs(dy)){
        if (dx < 0) next(); else prev();
      }
    }, {passive:true});

    // If image missing
    galleryImg.addEventListener('error', () => {
      document.getElementById('galleryTitle').textContent =
        "Add images named 1.jpeg to 10.jpeg in this folder üì∏";
      closeGalleryBtn.textContent = "Back üòÖ";
      frame.style.display = "none";
      dotsEl.style.display = "none";
      counterText.textContent = "";
    });

    // Music control (play only in modal)
    async function playMusic(){
      try { await music.play(); } catch(e){ console.log("Music blocked/missing:", e); }
    }
    function stopMusic(){
      music.pause();
      music.currentTime = 0;
    }

    function openGallery(){
      goTo(0);
      galleryModal.setAttribute('open','');
      playMusic();
      popConfetti();
    }

    function closeGallery(){
      galleryModal.removeAttribute('open');
      stopMusic();
    }

    closeGalleryBtn.addEventListener('click', closeGallery);
    galleryModal.addEventListener('click', (e) => {
      if (e.target === galleryModal) closeGallery();
    });

    yesBtn.addEventListener('click', openGallery);
  </script>
</body>
</html>
